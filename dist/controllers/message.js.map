{"version":3,"file":"message.js","names":["rootIndex","require","CoinMarketCapService","randomJoke","fundBalance","printFund","news","convertCurrencyHandler","msg","match","chatId","chat","id","price","getExchangeRateBySlug","groups","curr","convertedPrice","value","bot","sendMessage","module","exports","getJokeHandler","joke","getRandomJoke","getDropsTabProfileHandler","balance","getDropsTabBalance","mess","fundInfoHandler","parse_mode","getTopNews","newsList","getNews","responseText","map","header","content","link","newMessageHandler","text","messageText","toUpperCase","console","log","availableСurrencies","find","slug","rates","getExchangeRatesBySlugs","forEach","rate","info","currency","blockhain","dayChange","newChatMember","sendPhoto","caption","new_chat_member","first_name","leftChatMember","left_chat_participant"],"sources":["../../src/controllers/message.js"],"sourcesContent":["const rootIndex = require(\"..\");\nconst CoinMarketCapService = require(\"../services/coin-market-cap\");\nconst randomJoke = require('../services/joke');\nconst fundBalance = require('../services/dropstab');\nconst printFund = require('../utils');\nconst news  = require(\"../services/news\")\n\nconst convertCurrencyHandler = async (msg, match) => {\n\tconst chatId = msg.chat.id;\n\tconst price = await CoinMarketCapService.getExchangeRateBySlug(match.groups.curr);\n\tconst convertedPrice = price * match.groups.value;\n\trootIndex.bot.sendMessage(chatId, `${convertedPrice}\\uD83D\\uDCB5`);\n};\n\nmodule.exports.convertCurrencyHandler = convertCurrencyHandler;\n\nconst getJokeHandler = async (msg) => {\n\tconst chatId = msg.chat.id;\n\tconst joke = await randomJoke.getRandomJoke();\n\trootIndex.bot.sendMessage(chatId, joke + '\\n');\n}\n\nmodule.exports.getJokeHandler = getJokeHandler;\n\nconst getDropsTabProfileHandler = async (msg) => {\n\tconst chatId = msg.chat.id;\n\tconst balance = await fundBalance.getDropsTabBalance();\n\tconst mess = printFund.fundInfoHandler(balance);\n\trootIndex.bot.sendMessage(chatId, mess, {\n\t\tparse_mode: 'HTML'\n\t});\n}\n\nmodule.exports.getDropsTabProfileHandler = getDropsTabProfileHandler;\n\nconst getTopNews = async (msg) => {\n\tconst chatId = msg.chat.id;\n\tconst newsList = await news.getNews();\n\tlet responseText = '';\n\tnewsList.map((news) => {\n\t\tresponseText += `<b>${news.header}</b>\n${news.content} \nСсылка на статью - ${news.link} \\n`;\n\t})\n\trootIndex.bot.sendMessage(chatId, responseText, {\n\t\tparse_mode: 'HTML'\n\t})\n}\n\nmodule.exports.getTopNews = getTopNews;\n\nconst newMessageHandler = async (msg) => {\n\tif (typeof msg.text !== 'undefined') {\n\t\tconst messageText = msg.text.toUpperCase();\n\t\tconsole.log(rootIndex.availableСurrencies)\n\t\tif (rootIndex.availableСurrencies?.find(({ slug }) => slug === messageText)) {\n\t\t\tconsole.log('a')\n\t\t\tconst rates = await CoinMarketCapService.getExchangeRatesBySlugs([messageText]);\n\n\t\t\trates.forEach((rate) => {\n\t\t\t\tconsole.log(rate.info);\n\t\t\t\tconst responseText = `\nНазвание: ${rate.currency}\nЦена: ${rate.value}\nБлокчейн: ${rate.blockhain}\nИзменения за 24 часа: ${rate.dayChange}`;\nrootIndex.bot.sendMessage(msg.chat.id, responseText);\n\t\t\t});\n\t\t} else if (messageText === 'Да это бред'.toUpperCase()) {\n\t\t\trootIndex.bot.sendMessage(msg.chat.id, 'Согласен');\n\t\t} else if (messageText === 'Пошел нахуй'.toUpperCase() || messageText === 'Пошёл нахуй'.toUpperCase() || messageText === 'Иди нахуй'.toUpperCase()) {\n\t\t\trootIndex.bot.sendMessage(msg.chat.id, 'Сам пошел');\n\t\t} else if (messageText === 'Бля'.toUpperCase()) {\n\t\t\tconsole.log(msg.chat.id)\n\t\t\trootIndex.bot.sendMessage(msg.chat.id, 'Не ругайся');\n\t\t}\n\t}\n}\n\nmodule.exports.newMessageHandler = newMessageHandler;\n\nconst newChatMember = (msg) => {\n\tconst chatId = msg.chat.id;\n\trootIndex.bot.sendPhoto(\n\t\tchatId,\n\t\t'https://avatars.mds.yandex.net/get-images-cbir/516543/hWbMF_mtRBHJcXd17iP-5A4300/ocr',\n\t\t{\n\t\t\tcaption: `Добро пожаловать, ${msg.new_chat_member.first_name}. Запомни эти простые правила`\n\t\t}\n\t);\n}\n\nmodule.exports.newChatMember = newChatMember;\n\nconst leftChatMember = (msg) => {\n\tconst chatId = msg.chat.id;\n\trootIndex.bot.sendMessage(chatId, `Давай, ${msg.left_chat_participant.first_name}, до свидания`);\n}\n\nmodule.exports.leftChatMember = leftChatMember;\n"],"mappings":"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"}