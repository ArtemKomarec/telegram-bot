{"version":3,"file":"message.js","names":["rootIndex","require","CoinMarketCapService","randomJoke","randomMeme","fundBalance","printFund","news","convertCurrencyHandler","msg","match","chatId","chat","id","price","getExchangeRateBySlug","groups","curr","convertedPrice","Number","value","bot","sendMessage","toFixed","module","exports","getJokeHandler","joke","getRandomJoke","getMemeHandler","meme","getRandomMeme","sendPhoto","getDropsTabProfileHandler","balance","getDropsTabBalance","mess","fundInfoHandler","parse_mode","getTopNews","newsList","getNews","responseText","map","header","content","link","newMessageHandler","text","messageText","toUpperCase","console","log","availableСurrencies","find","slug","rates","getExchangeRatesBySlugs","forEach","rate","info","currency","blockhain","dayChange","newChatMember","caption","new_chat_member","first_name","leftChatMember","left_chat_participant"],"sources":["../../src/controllers/message.js"],"sourcesContent":["const rootIndex = require(\"..\");\nconst CoinMarketCapService = require(\"../services/coin-market-cap\");\nconst randomJoke = require(\"../services/joke\");\nconst randomMeme = require(\"../services/memes\");\nconst fundBalance = require(\"../services/dropstab\");\nconst printFund = require(\"../utils\");\nconst news = require(\"../services/news\");\n\nconst convertCurrencyHandler = async (msg, match) => {\n\tconst chatId = msg.chat.id;\n\tconst price = await CoinMarketCapService.getExchangeRateBySlug(\n\t\tmatch.groups.curr\n\t);\n\tconst convertedPrice = price * Number(match.groups.value);\n\tif (convertedPrice) {\n\t\trootIndex.bot.sendMessage(\n\t\t\tchatId,\n\t\t\t`${convertedPrice.toFixed(2)}\\uD83D\\uDCB5`\n\t\t);\n\t} else {\n\t\trootIndex.bot.sendMessage(\n\t\t\tchatId,\n\t\t\t`Неправильный формат сообщения. Пример: /convert 0.05 btc`\n\t\t);\n\t}\n};\n\nmodule.exports.convertCurrencyHandler = convertCurrencyHandler;\n\nconst getJokeHandler = async (msg) => {\n\tconst chatId = msg.chat.id;\n\tconst joke = await randomJoke.getRandomJoke();\n\trootIndex.bot.sendMessage(chatId, joke + \"\\n\");\n};\n\nconst getMemeHandler = async (msg) => {\n\tconst chatId = msg.chat.id;\n\tconst meme = await randomMeme.getRandomMeme();\n\trootIndex.bot.sendPhoto(chatId, meme);\n};\n\nmodule.exports.getMemeHandler = getMemeHandler;\n\nmodule.exports.getJokeHandler = getJokeHandler;\n\nconst getDropsTabProfileHandler = async (msg) => {\n\tconst chatId = msg.chat.id;\n\tconst balance = await fundBalance.getDropsTabBalance();\n\tconst mess = printFund.fundInfoHandler(balance);\n\trootIndex.bot.sendMessage(chatId, mess, {\n\t\tparse_mode: \"HTML\",\n\t});\n};\n\nmodule.exports.getDropsTabProfileHandler = getDropsTabProfileHandler;\n\nconst getTopNews = async (msg) => {\n\tconst chatId = msg.chat.id;\n\tconst newsList = await news.getNews();\n\tlet responseText = \"\";\n\tnewsList.map((news) => {\n\t\tresponseText += `<b>${news.header}</b>\n${news.content} \nСсылка на статью - ${news.link} \\n`;\n\t});\n\trootIndex.bot.sendMessage(chatId, responseText, {\n\t\tparse_mode: \"HTML\",\n\t});\n};\n\nmodule.exports.getTopNews = getTopNews;\n\nconst newMessageHandler = async (msg) => {\n\tif (typeof msg.text !== \"undefined\") {\n\t\tconst messageText = msg.text.toUpperCase();\n\t\tconsole.log(rootIndex.availableСurrencies);\n\t\tif (\n\t\t\trootIndex.availableСurrencies?.find(({ slug }) => slug === messageText)\n\t\t) {\n\t\t\tconsole.log(\"a\");\n\t\t\tconst rates = await CoinMarketCapService.getExchangeRatesBySlugs([\n\t\t\t\tmessageText,\n\t\t\t]);\n\n\t\t\trates.forEach((rate) => {\n\t\t\t\tconsole.log(rate.info);\n\t\t\t\tconst responseText = `\nНазвание: ${rate.currency}\nЦена: ${rate.value}\nБлокчейн: ${rate.blockhain}\nИзменения за 24 часа: ${rate.dayChange}`;\n\t\t\t\trootIndex.bot.sendMessage(msg.chat.id, responseText);\n\t\t\t});\n\t\t} else if (messageText === \"Да это бред\".toUpperCase()) {\n\t\t\trootIndex.bot.sendMessage(msg.chat.id, \"Согласен\");\n\t\t} else if (\n\t\t\tmessageText === \"Пошел нахуй\".toUpperCase() ||\n\t\t\tmessageText === \"Пошёл нахуй\".toUpperCase() ||\n\t\t\tmessageText === \"Иди нахуй\".toUpperCase()\n\t\t) {\n\t\t\trootIndex.bot.sendMessage(msg.chat.id, \"Сам пошел\");\n\t\t} else if (messageText === \"Бля\".toUpperCase()) {\n\t\t\tconsole.log(msg.chat.id);\n\t\t\trootIndex.bot.sendMessage(msg.chat.id, \"Не ругайся\");\n\t\t}\n\t}\n};\n\nmodule.exports.newMessageHandler = newMessageHandler;\n\nconst newChatMember = (msg) => {\n\tconst chatId = msg.chat.id;\n\trootIndex.bot.sendPhoto(\n\t\tchatId,\n\t\t\"https://avatars.mds.yandex.net/get-images-cbir/516543/hWbMF_mtRBHJcXd17iP-5A4300/ocr\",\n\t\t{\n\t\t\tcaption: `Добро пожаловать, ${msg.new_chat_member.first_name}. Запомни эти простые правила`,\n\t\t}\n\t);\n};\n\nmodule.exports.newChatMember = newChatMember;\n\nconst leftChatMember = (msg) => {\n\tconst chatId = msg.chat.id;\n\trootIndex.bot.sendMessage(\n\t\tchatId,\n\t\t`Давай, ${msg.left_chat_participant.first_name}, до свидания`\n\t);\n};\n\nmodule.exports.leftChatMember = leftChatMember;\n"],"mappings":"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"}